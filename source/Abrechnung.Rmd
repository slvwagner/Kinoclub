---
title: Abrechnung Filmvorführung
author: "Nadia Wagner"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r variablen, include=FALSE}
ii <- 2
```

## Erfolg
Der Erfolg berechnet sich aus dem Gewinn der Eintritte und des Kiosks. 

```{r echo=FALSE}
c_suisa <- df_show$suisa_nr[ii]
c_Datum <- df_show$Datum[ii]
```


```{r echo=FALSE}
df_GV_Vorfuehrung|>
  left_join(df_show,by = join_by(Datum, suisa_nr))|>
  filter(Datum == c_Datum & suisa_nr == c_suisa)|>
  select(Datum, Anfang, suisa_nr, Filmtitel, `Gewinn/Verlust`)|>
  arrange(Datum)|> 
  knitr::kable()
```


Im folgende wird die Abrechnung aufgrund der beiden Datensätze Kino-Eintritte und Kiosk-Umsatz erstellt. Die Datensätze sind von https://www.advance-ticket.ch/admin heruntergeladen worden.
```{r echo=FALSE}

c_verleiherabgaben <- df_verleiherabgaben|>
  filter(Datum == c_Datum & Suisa == c_suisa)|>
  select(`Abzug [%]`)|>
  pull()

df_show|>
  filter(Datum == c_Datum & suisa_nr == c_suisa)|>
  knitr::kable()
```


## Kino Eintritte

```{r echo=FALSE}

df_Eintritt|>
  filter(Datum == c_Datum & suisa_nr == c_suisa)|>
  select(Platzkategorie, Verkaufspreis, Anzahl, Umsatz)|>
  rename(`Umsatz [sFR]` = `Umsatz`,
         `Verkaufspreis [sFr]`=`Verkaufspreis`)|>
  knitr::kable()

```


Für diesen Film muss an den Verleiher **`r c_verleiherabgaben`%** des Ticket-Umsatz gezahlt werden. Die minimale Abgaben an den Verleiher ist **CHF 150.-**
Der Abgabeprozentsatz ist für jeden Film und Spielwoche mit dem jeweiligen Verleiher verhandelt.
```{r echo=FALSE}
df_GV_Eintritt|>
  filter(Datum == c_Datum & suisa_nr == c_suisa)|>
  select(-Datum,-Anfang,-suisa_nr,-Filmtitel)|>
  rename(`Umsatz [sFr]` = Umsatz,
         `Gewinn/Verlust [sFr]` = `Gewinn/Verlust`
         )|>
    knitr::kable()

```


## Kiosk

```{r echo=FALSE}
df_Kiosk|>
  filter(Datum == c_Datum)|>
  select(-Betrag)|>
  rename(`Kassiert [sFR]` = `Kassiert`,
         `Einkaufspreis [sFr]` =`Einkaufspreis`,
         `Gewinn [sFr]` = `Gewinn`,
         `Verkaufspreis [sFr]`=`Verkaufspreis`)|>
  knitr::kable()

```


```{r echo=FALSE}
df_GV_Kiosk|>
  filter(Datum == c_Datum)|>
  knitr::kable()

```


# Gewinn/Verlust der Filmvorführung
```{r echo=FALSE}
df_GV_Vorfuehrung|>
  filter(Datum == c_Datum & suisa_nr == c_suisa)|>
  knitr::kable()
```





